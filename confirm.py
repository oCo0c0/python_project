def process_multiple_amounts(groups):
    sql_statements = []

    for group in groups:
        id_list = group['id_list']
        amount_list = group['amount_list']

        if len(id_list) != len(amount_list):
            raise ValueError("ID 列表和金额列表的长度必须相同")

        neg_index = next((i for i, amount in enumerate(amount_list) if amount < 0), None)

        if neg_index is None:
            raise ValueError("在列表中未找到负数")

        neg_id = id_list[neg_index]
        neg_amount = amount_list[neg_index]

        pos_index = next((i for i, amount in enumerate(amount_list) if amount > 0), None)

        if pos_index is None:
            raise ValueError("在列表中未找到正数")
        pos_id = id_list[pos_index]
        pos_amount = amount_list[pos_index]

        new_pos_amount = pos_amount + neg_amount
        sql_statements.append(
            f"apps.fin_period_pkg.ar_confirm_amount({pos_id}, null, {new_pos_amount:.6f}, null, null, 'Y', null, null,null);")
        sql_statements.append(
            f"apps.fin_period_pkg.ar_confirm_amount({neg_id}, null, 0, null, null, 'Y', null, null,null);")
        #sql_statements.append(f"UPDATE tn_fin_ar_confirm SET tax_amount = {new_pos_amount:.6f} WHERE id = {pos_id};")
        #sql_statements.append(f"UPDATE tn_fin_ar_confirm SET tax_amount = 0 WHERE id = {neg_id};")

    return sql_statements


# Example usage
groups = [
{'id_list': [33073186,33081628], 'amount_list': [25.107143,-.000003]},
{'id_list': [32722289,32711931], 'amount_list': [-.000002,21.578572]},
{'id_list': [32619706,32612412], 'amount_list': [-.000002,46.666667]},
{'id_list': [32557077,32543637], 'amount_list': [-.000001,30.286639]},
{'id_list': [32924678,32921640], 'amount_list': [-.000004,26.079496]},
{'id_list': [33150156,33162959,33155011], 'amount_list': [26.079496,-.000006,26.079496]},
{'id_list': [32663121,32680397,32663127], 'amount_list': [20.357143,-.000001,20.357143]},
{'id_list': [32571811,32633226], 'amount_list': [30.764034,-.000002]},
{'id_list': [32532773,32502309], 'amount_list': [-.000001,35.964286]},
{'id_list': [32525640,32517494,32517385,32517382], 'amount_list': [-.000001,35.964286,35.964286,35.964286]},
{'id_list': [32728677,32718072], 'amount_list': [-.000002,35.828572]},
{'id_list': [32516907,32531678,32516910], 'amount_list': [29.178572,-.000001,29.178572]},
{'id_list': [32518244,32532767,32518274], 'amount_list': [38.678572,-.000001,38.678572]},
{'id_list': [32518311,32532788,32518317], 'amount_list': [29.178572,-.000001,29.178572]},
{'id_list': [32532782,32527537,32527531,32527528], 'amount_list': [-.000001,20.34916,20.34916,20.34916]},
{'id_list': [32525744,32511070,32510946,32510823], 'amount_list': [-.000001,21.714286,21.714286,21.714286]},
{'id_list': [32544584,32553093,32544587], 'amount_list': [51.978572,-.000001,51.978572]},
{'id_list': [32543748,32543869,32543690,32557459], 'amount_list': [19.678572,19.678572,19.678572,-.000002]},
{'id_list': [32647381,32652467,32647451], 'amount_list': [40.578572,-.000001,40.578572]},
{'id_list': [32511905,32518263], 'amount_list': [24.166667,-.000001]},
{'id_list': [32508220,32519081,32512591,32508444], 'amount_list': [23.166667,-.000001,23.166667,23.166667]},
{'id_list': [32512581,32519102,32512636], 'amount_list': [31.666667,-.000001,31.666667]},
{'id_list': [32637361,32582909,32582906,32582905,32582904], 'amount_list': [-.000001,35.964286,35.964286,35.964286,35.964286]},
{'id_list': [32647610,32652495,32647689], 'amount_list': [40.578572,-.000001,40.578572]},
{'id_list': [32638468,32632828,32643172], 'amount_list': [23.591933,23.591933,-.000001]},
{'id_list': [32508666,32500454,32504190], 'amount_list': [-.000001,36.666667,36.666667]},
{'id_list': [32504512,32512367,32504514], 'amount_list': [37.166667,-.000001,37.166667]},
{'id_list': [32500814,32503110,32502735,32511879], 'amount_list': [12.166667,12.166667,12.166667,-.000001]},
{'id_list': [32588359,32591748,32591509,32597608,32591183], 'amount_list': [40.714286,40.714286,40.714286,-.000001,40.714286]},
{'id_list': [32583639,32597718,32583862,32583730], 'amount_list': [21.714286,-.000001,21.714286,21.714286]},
{'id_list': [32688966,32632734,32632732,32632730,32632727,32632725,32632716,32632714,32632711,32632709,32632906], 'amount_list': [-.000002,29.857143,29.857143,29.857143,29.857143,29.857143,29.857143,29.857143,29.857143,29.857143,29.857143]},
{'id_list': [32638804,32632902,32679670,32638810], 'amount_list': [21.714286,21.714286,-.000001,21.714286]},
{'id_list': [32666900,32679786,32666922], 'amount_list': [29.178572,-.000001,29.178572]},
{'id_list': [32667647,32714128,32667841,32667788], 'amount_list': [35.964286,-.000001,35.964286,35.964286]},
{'id_list': [32666927,32699359,32666933], 'amount_list': [45.071513,-.000001,45.071513]},
{'id_list': [32693752,32702213], 'amount_list': [35.964286,-.000002]},
{'id_list': [32705213,32700158,32700157,32700155], 'amount_list': [-.000002,38.678572,38.678572,38.678572]},
{'id_list': [32714059,32723827,32707854,32707852,32707819,32708275,32708252,32708247], 'amount_list': [29.178572,-.000004,29.178572,29.178572,29.178572,29.178572,29.178572,29.178572]},
{'id_list': [32737601,32695949,32695924], 'amount_list': [-.000001,50.078572,50.078572]},
{'id_list': [32737081,32746141,32737103,32737082], 'amount_list': [12.214286,-.000001,12.214286,12.214286]},
{'id_list': [32737195,32732164,32732086], 'amount_list': [-.000001,23.591933,23.591933]},
{'id_list': [32745909,32755574,32745921], 'amount_list': [24.428572,-.000001,24.428572]},
{'id_list': [32772709,32776829,32772722], 'amount_list': [24.428572,-.000001,24.428572]},
{'id_list': [32743381,32743368,32765869,32743266,32743127], 'amount_list': [35.964286,35.964286,-.000001,35.964286,35.964286]},
{'id_list': [32762567,32766166,32762574,32762572,32762570], 'amount_list': [19.678572,-.000002,19.678572,19.678572,19.678572]},
{'id_list': [32765465,32775038,32765466], 'amount_list': [17.778572,-.000001,17.778572]},
{'id_list': [32540629,32545828,32539299,32539187], 'amount_list': [41.666667,-.000001,41.666667,41.666667]},
{'id_list': [32794836,32804440,32794852], 'amount_list': [23.278992,-.000001,23.278992]},
{'id_list': [32537199,32545585,32540528], 'amount_list': [24.166667,-.000001,24.166667]},
{'id_list': [32848925,32839080,32838951,32838836,32838654,32839284], 'amount_list': [-.000003,33.928572,33.928572,33.928572,33.928572,33.928572]},
{'id_list': [32540532,32545966,32537005,32540711], 'amount_list': [41.666667,-.000001,41.666667,41.666667]},
{'id_list': [32839870,32850457,32840245,32840207], 'amount_list': [31.214286,-.000001,31.214286,31.214286]},
{'id_list': [32541018,32554405,32541035,32541024], 'amount_list': [26.666667,-.000001,26.666667,26.666667]},
{'id_list': [32549469,32536440,32536606,32536397], 'amount_list': [-.000001,26.666667,26.666667,26.666667]},
{'id_list': [32861206,32850908,32850892], 'amount_list': [-.000001,24.428572,24.428572]},
{'id_list': [33137677,33133367], 'amount_list': [-.000007,31.757143]},
{'id_list': [32865325,32850990,32850988], 'amount_list': [-.000001,29.178572,29.178572]},
{'id_list': [32874386,32905643,32874388], 'amount_list': [24.428572,-.000001,24.428572]},
{'id_list': [32901323,32897519,32901363,32901356,32901344,32905634,32901331], 'amount_list': [24.428572,24.428572,24.428572,24.428572,24.428572,-.000004,24.428572]},
{'id_list': [32900320,32905548,32900487], 'amount_list': [38.678572,-.000001,38.678572]},
{'id_list': [32558894,32565745,32558897], 'amount_list': [36.666667,-.000001,36.666667]},
{'id_list': [32567059,32560239,32559116], 'amount_list': [-.000001,1.666667,1.666667]},
{'id_list': [32924642,32917849,32917572,32917307,32917255], 'amount_list': [-.000001,26.464286,26.464286,26.464286,26.464286]},
{'id_list': [32945894,32934550,32934889], 'amount_list': [-.000001,23.278992,23.278992]},
{'id_list': [32951786,32939056,32939009,32938697], 'amount_list': [-.000001,29.857143,29.857143,29.857143]},
{'id_list': [32572756,32579457,32570963], 'amount_list': [41.666667,-.000001,41.666667]},
{'id_list': [32967105,32967512,32975418,32967348,32967324,32967318,32967153,32967111], 'amount_list': [29.178572,29.178572,-.000004,29.178572,29.178572,29.178572,29.178572,29.178572]},
{'id_list': [32973798,32966166,32966146], 'amount_list': [-.000001,24.428572,24.428572]},
{'id_list': [32970369,32957239,32957232], 'amount_list': [-.000001,26.328572,26.328572]},
{'id_list': [32954076,32971146,32954088], 'amount_list': [38.678572,-.000001,38.678572]},
{'id_list': [32959430,32970919,32953413,32953859,32953844,32953828], 'amount_list': [29.178572,-.000003,29.178572,29.178572,29.178572,29.178572]},
{'id_list': [32579518,32572818,32571532], 'amount_list': [-.000001,26.666667,26.666667]},
{'id_list': [32964092,32960365,32960133], 'amount_list': [-.000001,40.578572,40.578572]},
{'id_list': [33021699,33009876,33009873,33009886], 'amount_list': [-.000002,52.928572,52.928572,52.928572]},
{'id_list': [32584982,32579460,32578606], 'amount_list': [-.000001,29.166667,29.166667]},
{'id_list': [33021580,33026638,33021584,33021582], 'amount_list': [38.678572,-.000002,38.678572,38.678572]},
{'id_list': [32579867,32575471,32585514], 'amount_list': [23.166667,23.166667,-.000001]},
{'id_list': [33041482,33012420], 'amount_list': [-.000001,15.878572]},
{'id_list': [32575938,32578325,32583948], 'amount_list': [1.666667,1.666667,-.000001]},
{'id_list': [33052682,33067563,33052688], 'amount_list': [24.428572,-.000001,24.428572]},
{'id_list': [33058223,33049920,33049900], 'amount_list': [-.000001,29.178572,29.178572]},
{'id_list': [33047109,33063089,33047111,33047110], 'amount_list': [21.714286,-.000001,21.714286,21.714286]},
{'id_list': [33070128,33075034,33070136], 'amount_list': [18.728572,-.000001,18.728572]},
{'id_list': [32588702,32582977,32582914], 'amount_list': [-.000001,51.666667,51.666667]},
{'id_list': [32588927,32583044,32583042,32583001,32582947], 'amount_list': [-.000001,29.166667,29.166667,29.166667,29.166667]},
{'id_list': [32588902,32583028,32582912], 'amount_list': [-.000001,29.166667,29.166667]},
{'id_list': [33094770,33091712,33091710], 'amount_list': [-.000001,24.428572,24.428572]},
{'id_list': [33102324,33107804,33102338,33102328,33102326], 'amount_list': [24.428572,-.000002,24.428572,24.428572,24.428572]},
{'id_list': [33115586,33111031,33111024,33111017], 'amount_list': [-.000002,13.978572,13.978572,13.978572]},
{'id_list': [33101394,33101387,33101385,33101383,33101381,33101380,33101378,33101377,33101374,33106522,33101454,33101401], 'amount_list': [16.964286,16.964286,16.964286,16.964286,16.964286,16.964286,16.964286,16.964286,16.964286,-.000003,16.964286,16.964286]},
{'id_list': [33101455,33106716,33101466,33101465], 'amount_list': [24.428572,-.000002,24.428572,24.428572]},
{'id_list': [33109396,33153607,33109438,33109425,33109413,33109406], 'amount_list': [35.964286,-.000002,35.964286,35.964286,35.964286,35.964286]},
{'id_list': [32600248,32599481,32612172], 'amount_list': [29.166667,29.166667,-.000001]},
{'id_list': [33147692,33163070,33145336,33145329], 'amount_list': [35.964286,-.000001,35.964286,35.964286]},
{'id_list': [32612014,32606883,32604342], 'amount_list': [-.000001,41.666667,41.666667]},
{'id_list': [32611425,32605757,32605746], 'amount_list': [-.000001,26.666667,26.666667]},
{'id_list': [33150373,33166859,33155376], 'amount_list': [29.178572,-.000001,29.178572]},
{'id_list': [33155346,33163071,33155415], 'amount_list': [30.764034,-.000001,30.764034]},
{'id_list': [33155325,33166872,33155403], 'amount_list': [18.299076,-.000001,18.299076]},
{'id_list': [32610384,32603259,32603186,32603025,32602976,32602834], 'amount_list': [-.000002,51.666667,51.666667,51.666667,51.666667,51.666667]},
{'id_list': [32603397,32610365,32603328,32603179,32603125], 'amount_list': [26.666667,-.000001,26.666667,26.666667,26.666667]},
{'id_list': [33129921,33157807], 'amount_list': [40.578572,-.000001]},
{'id_list': [33154912,33162949,33154918], 'amount_list': [23.591933,-.000001,23.591933]},
{'id_list': [33129903,33157821], 'amount_list': [40.578572,-.000001]},
{'id_list': [33150187,33154993,33154987,33166585,33150188], 'amount_list': [26.079496,26.079496,26.079496,-.000001,26.079496]},
{'id_list': [33123621,33139306,33123623], 'amount_list': [29.178572,-.000001,29.178572]},
{'id_list': [33118620,33147591,33118621], 'amount_list': [17.778572,-.000001,17.778572]},
{'id_list': [33124117,33143296,33119117], 'amount_list': [29.178572,-.000001,29.178572]},
{'id_list': [33124504,33119268,33148861], 'amount_list': [29.178572,29.178572,-.000001]},
{'id_list': [32604855,32604972,32610856], 'amount_list': [21.666667,21.666667,-.000001]},
{'id_list': [33150356,33191113,33150396], 'amount_list': [25.501513,-.000001,25.501513]},
{'id_list': [33150018,33185841,33150012,33150026,33150020], 'amount_list': [35.964286,-.000001,35.964286,35.964286,35.964286]},
{'id_list': [32603350,32603222,32610415], 'amount_list': [26.666667,26.666667,-.000001]},
{'id_list': [33190745,33181764], 'amount_list': [-.000002,24.428572]},
{'id_list': [33197299,33188005,33187963,33187859], 'amount_list': [-.000002,15.878572,15.878572,15.878572]},
{'id_list': [33167588,33180370,33167632], 'amount_list': [33.928572,-.000001,33.928572]},
{'id_list': [33172730,33180325,33167354,33167353], 'amount_list': [24.428572,-.000002,24.428572,24.428572]},
{'id_list': [32596799,32606091,32611642], 'amount_list': [1.666667,1.666667,-.000001]},
{'id_list': [32597339,32598613,32611617], 'amount_list': [41.666667,41.666667,-.000001]},
{'id_list': [33187125,33182283,33182178,33182174], 'amount_list': [-.000002,29.178572,29.178572,29.178572]},
{'id_list': [32612602,32600715,32600714], 'amount_list': [-.000001,24.166667,24.166667]},
{'id_list': [33186785,33181979,33181971], 'amount_list': [-.000001,23.591933,23.591933]},
{'id_list': [33228531,33177885,33177812], 'amount_list': [-.000001,38.678572,38.678572]},
{'id_list': [33172604,33180309,33172672,33172656], 'amount_list': [31.214286,-.000001,31.214286,31.214286]},
{'id_list': [33229820,33220368,33220361], 'amount_list': [-.000001,24.428572,24.428572]},
{'id_list': [33229924,33220417,33224533], 'amount_list': [-.000001,24.428572,24.428572]},
{'id_list': [33232493,33220382,33220180,33220174,33220048], 'amount_list': [-.000002,38.678572,38.678572,38.678572,38.678572]},
{'id_list': [33230271,33221614,33221612,33221554,33224356,33224690,33224681], 'amount_list': [-.000004,29.178572,29.178572,29.178572,29.178572,29.178572,29.178572]},
{'id_list': [33220870,33232562,33221076,33221069], 'amount_list': [24.428572,-.000002,24.428572,24.428572]},
{'id_list': [33248822,33219491,33219469,33219409], 'amount_list': [-.000001,26.406807,26.406807,26.406807]},
{'id_list': [32618156,32689454], 'amount_list': [29.166667,-.000001]},
{'id_list': [32619167,32689856,32617578], 'amount_list': [41.666667,-.000001,41.666667]},
{'id_list': [33240316,33243105,33243102], 'amount_list': [35.828572,-.000001,35.828572]},
{'id_list': [33234479,33238013,33234483], 'amount_list': [24.428572,-.000001,24.428572]}
]

sqls = process_multiple_amounts(groups)
for sql in sqls:
    print(sql)
